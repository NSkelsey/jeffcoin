<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"> 
        <title>Alpha: Ruckus</title>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.js"></script>
        <link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet" />
        <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

        <script src="/static/bitcore.js"></script>
        <script src="/static/sjcl/sjcl.js"></script>
        <script src="/static/utils.js"></script>


        <style>
            .form-inline .form-control {
                display: inline-block;
            }

            textarea {
                resize: none;
            }

            #build {
                margin: 0px auto;
                display: inherit;
                font-size: 22px;
            }
    

            .button-row {
                margin: 20px auto 20px auto;
            }

            .human-string {
                display: inline-block;
            }

            .hashtag {
                padding: 7.5px;
                display: inline-block;
            }

            .bulletin {
                border-radius: 8px;
                border: 1px solid #DDDDDD;
                padding: 20px;
                -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.05);
                box-shadow: inset 0 1px 1px rgba(0,0,0,.05);
                margin-bottom: 40px;
            }

            .message-wrap {
                margin: 10px auto 10px auto;
            }   

            .badge {
                background-color: #428bca;
            }

            .head-info {
                float: right;
                display: inline-block;
                padding: 7.5px;
            }

            .head .head-addr {
                margin-top: 0px;  
                margin-bottom: 0px;
            }


            .bulletin .foot p {
                float: right;
                color: #888;                
                margin-bottom: 0px;
            }

            #raw-tx {
                display: None;
            }

            #raw-bytes {
                margin-top: 10px;
            }

            #raw-error {
                display: None;
            }

        </style>

    </head>
    <body>
        <div class="container">
            <div class="row">
                <div class="col-xs-8">
                    <h2>Create a new Bulletin! <small>From the comfort of your browser</small></h2> 
                    <p>Enter your private key for the address you want to send from, your message and any hashtags you want to tag your bulletin with.</p> 
                    
                    <!-- form input for a bulletin -->
                    <form class="form-horizontal" role="form">

                    <div class="form-group">
                        <label for="privKey" class="col-sm-2 control-label">Private Key</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="privKey" placeholder="Hex string"
                            value="cVDc9YDMLJPhi6n44KnXRGR1d4Ugabg1ZxnkLg8rMgSVdQN7JiTD"
                            >
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="txid-1" class="col-sm-2 control-label">Input Txid</label>
                        <div class="col-sm-6">
                            <input type="text" class="form-control" id="txin-txid-1" placeholder="Hash of a txout"
                            value="56b9a1b2dd39c61f43103293513fe1366a3db4b52bc952a5a2528f4fb3e9fca1"
                            >
                        </div>
                        <div class="col-sm-2">
                            <input type="text" class="form-control" id="txin-index-1" placeholder="Index"
                            value=1
                            >
                        </div>
                        <div class="col-sm-2">
                            <input type="text" class="form-control" id="txin-value-1" placeholder="Value"
                            value=0.250
                            >
                        </div>
                        
                    </div>
    
                    <div class="form-group">
                        <label for="message" class="col-sm-2 control-label">Message</label>
                        <div class="col-sm-10">
                            <textarea rows=3 maxlength=140 class="form-control" id="message" placeholder="Write your message here">
I would just like to say that hustlers are gonna hustle. Regardless of the circumstances.
</textarea>
                        </div>
                    </div>


                    <div class="form-group"> 
                        <label for="hashtag-1" class="col-sm-2 control-label">Hashtags</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control" id="hashtag-1" value="Ruckus">
                        </div>
                        <span class="glyphicon glyphicon-minus"></span>
                    </div>
                    <div class="form-group"> 
                        <div class="col-sm-9 col-sm-offset-2">
                            <input type="text" class="form-control" id="hashtag-2" placeholder="A human readable string">
                        </div>
                        <span class="glyphicon glyphicon-plus"></span>
                    </div>
                    </form>
                    <div class="row button-row">
                        <div class="col-sm-offset-3 col-sm-7">
                        <button type="button" id="build" class="btn-large btn btn-primary">Generate the Transaction</button>
                        </div>
                    </div>

                    <!-- Success form -->
                    <div class="alert alert-success" id="raw-tx">
                        <label>Raw Transaction</label>
                        <p>Copy and paste this into any client that can relay bitcoin transaction and your message will be 
                        stored!</p>
                        <textarea rows=10 class="form-control" id="raw-bytes" readonly onmouseover="this.select()" onmouseout="clearSelection()"></textarea>
                        
                    </div>

                    <!-- Error form -->
                    <div class="alert alert-danger" id="raw-error">
                        <label>Bad Parameters!</label>
                        <p class="msg"></p>
                    </div>

<script>
function clearSelection(){
    if (window.getSelection) {
      if (window.getSelection().empty) {  // Chrome
        window.getSelection().empty();
      } else if (window.getSelection().removeAllRanges) {  // Firefox
        window.getSelection().removeAllRanges();
      }
    } else if (document.selection) {  // IE?
      document.selection.empty();
    }
}

$(document).ready(function(){

var Glob = 3;

function buildTx() {
    var privKey58 = $('#privKey').val();

    
    var msg = $('#message').val();

    var hashtags = [$('#hashtag-1').val()];
    var txid = $('#txin-txid-1').val();
    var vout = Number($('#txin-index-1').val());
    var value = Number($('#txin-value-1').val());
    var txout = {txid: txid, 
                 vout: vout,
                 amount: value,
                 };

   // try {
        var hex = singleTx(msg, hashtags, txout, privKey58);
        $('#raw-error').css('display', 'none');
        $('#raw-tx').css('display', 'block');
        $('#raw-bytes').val(hex);
   /*} catch (error) {
        $('#raw-error').css('display', 'block');
        $('#raw-error .msg').val(error);
    }
   //*/
}

$("#build").on('click', function(){
    buildTx();
});


});
</script>

                    <br><br><br><br><br>

                    <input id="addr-validate" class="form-inline" type="text">
                    <button id="addr-button" class="btn btn-primary">Test Address</button>
                    <div id="addr-results" class="alert"></div>
<script>
$("#addr-button").on('click', function() {
    var addr = $('#addr-validate').val();
    var addr_bitcore = new Address(addr);
    var result_box = $("#addr-results");
    if (addr_bitcore.isValid()) {
        result_box.removeClass("alert-danger");
        result_box.addClass("alert-success");
        result_box.text("It's Valid!"); 
    } else {
        result_box.removeClass("alert-success");
        result_box.addClass("alert-danger");
        result_box.text("It's Broken!");
    }
});


</script>

                    <br><br><br><br><br><br>

                    <div class="bulletin" >
                        <!-- header row -->
                       <div class="row head">
                            <div class="col-sm-8">
                                <small class="head-date"><b>On May 5th 2014</b></small>                             
                                <h3 class="head-addr"><a href="/">1nskeLseyVda3La8xYp2asEzUoZgOp5</a></h3>
                                <small class="head-tagline"><b>Stored</b></small>                             
                            </div>
                            <div class="col-md-4 hidden-xs hidden-sm"><div class="alert-info alert head-info"><a class="alert-link" >Confirms</a> <span class="badge">32</span></div></div>
                        </div>
                        <!-- the message row -->
                        <div class="row">
                            <div class="col-sm-12">
                            <div class="message-wrap well">
                            <p>If you will not fight for right when you can easily win without blood shed; if you will not fight when your victory is sure and not too costly; you may come to the moment when you will have to fight with all the odds against you and only a precarious chance of survival. There may even be a worse case. You may have to fight when there is no hope of victory, because it is better to perish than to live as slaves.</p>
                            </div>
                            </div>
                        </div>
                        <!-- the tag row -->
                        <div class="row">
                            <!-- an individual hashtag -->
    
                            <div class="col-sm-6 col-md-3">
                                <div class="hashtag alert alert-success">
                                        <span class="glyphicon glyphicon-remove"></span>
                                        <a class="human-string alert-link">ELGamaLisMyG</a>
                                </div>
                            </div>

                            <div class="col-sm-6 col-md-3">
                                <div class="hashtag alert alert-success">
                                        <span class="glyphicon glyphicon-remove"></span>
                                        <a class="human-string alert-link">ABBSOnBitcoin</a>
                                </div>
                            </div>
                        </div>
                        <div class="foot row">
                            <div class="col-sm-12">
                            <p>
                                Size: 225 B,
                                Time to Confirm: 10 mins,
                                Fee: 0.000421 ฿
                            </p>
                            </div>
                        </div>
                    </div> 

                </div>     
            </div>
        </div>
    </body>
</html>
